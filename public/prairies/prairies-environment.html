<!DOCTYPE html>
<html lang="en">
<head>

    <title>Project Endangered</title>
    <meta name="description" content="Project Endagered WebVR">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" viewport-fit=cover>
    

    <!--New environment setup-->

    <!--External Components-->

    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/n5ro/aframe-physics-system@v4.0.1/dist/aframe-physics-system.min.js"></script>
    <script src="https://unpkg.com/aframe-physics-extras@0.1.2/dist/aframe-physics-extras.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component@1.2.0/dist/aframe-environment-component.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">


    <link rel="stylesheet" href="/css/prairies_stylesheet.css">
    <link rel="stylesheet" href="/css/prairies_loading_animation.css">


    <script src="js/pickup.js"></script>
    <script src="js/startExperience.js"></script>
    <script src="js/bucketTask.js"></script>
    <script src="js/userInterface.js"></script>
    <script src="js/factTask.js"></script>
    <script src="js/gun.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>



    <script> 
        function load_page(){
    
            deviceChoice = 0;
            deviceChoice= (localStorage.getItem("device"));
            console.log(deviceChoice);
    
    
            qr=new XMLHttpRequest();
    
            if (deviceChoice == 1){
                qr.open('get','prairies-UI-desktop.html');
            } else if(deviceChoice == 2){
                qr.open('get','prairies-UI-mobile.html');
            }
            qr.send();
            qr.onload=function(){includedContent.innerHTML=qr.responseText}
            };load_page();
    
        </script> 
    
</head>
<body>

    <div id="includedContent"></div>
    <a-scene start-experience renderer="gammaOutput: true;" shadow="type: pcfsoft" vr-mode-ui="enabled: false" id="scene" physics="restitution: 0; debug:false; shadow=autoUpdate: false">

        <a-assets timeout = "10000">
        
            <!--Envrionment Assets-->
            <a-asset-item id="environment-obj" crossorigin="anonymous" src="/assets/prairies_environment.glb"></a-asset-item> 
            <a-asset-item id="lily-obj" crossorigin="anonymous" src="/assets/lily_pad.glb"></a-asset-item> 
            <a-asset-item id="crop-obj" crossorigin="anonymous" src="/assets/crop.glb"></a-asset-item> 
            <a-asset-item id="bucket-obj" crossorigin="anonymous" src="/assets/bucket_empty.glb"></a-asset-item> 
            <a-asset-item id="target-obj" crossorigin="anonymous" src="/assets/target.glb"></a-asset-item> 
            <a-asset-item id="gun-obj" crossorigin="anonymous" src="/assets/gun.glb"></a-asset-item> 
            <a-asset-item id="sign-obj" crossorigin="anonymous" src="/assets/sign.glb"></a-asset-item> 
            <a-asset-item id="crane-obj" crossorigin="anonymous" src="/assets/crane.glb"></a-asset-item> 
            <a-asset-item id="craneGroup-obj" crossorigin="anonymous" src="/assets/crane_group.glb"></a-asset-item>
            <a-asset-item id="nav-mesh-obj" crossorigin="anonymous" src="/assets/nav-mesh/nav_mesh.gltf"></a-asset-item>

            <a-asset-item id="tooltip-obj" crossorigin="anonymous" src="/assets/tooltip.glb"></a-asset-item>
            <a-asset-item id="crop1-obj" crossorigin="anonymous" src="/assets/crop_group.glb"></a-asset-item> 

            <!--Audio Assets-->
            <audio id="water_sound" src="/assets/audio/water.mp3" preload="auto"></audio>
            <audio id="music_sound" src="/assets/audio/music.mp3" preload="auto"></audio>
            <audio id="marsh_sound" src="/assets/audio/marsh.mp3" preload="auto"></audio>
            <audio id="click_sound" src="/assets/audio/click.mp3" preload="auto"></audio>
            <audio id="splash_sound" src="/assets/audio/splash.mp3" preload="auto"></audio>
            <audio id="gun_sound" src="/assets/audio/gun.mp3" preload="auto"></audio>
            <audio id="pickup_sound" src="/assets/audio/pickup.mp3" preload="auto"></audio>
            
            <!--Text to Speech Assets-->
            <audio id="menu_instruction_desktop" src="/assets/audio/text/menu_desktop.mp3" preload="auto"></audio>
            <audio id="menu_instruction_mobile" src="/assets/audio/text/menu_mobile.mp3" preload="auto"></audio>
            <audio id="menu_settings" src="/assets/audio/text/menu_settings.mp3" preload="auto"></audio>
            <audio id="fact_big" src="/assets/audio/text/fact_big.mp3" preload="auto"></audio>
            <audio id="fact_gun" src="/assets/audio/text/fact_gun.mp3" preload="auto"></audio>
            <audio id="fact_population" src="/assets/audio/text/fact_population.mp3" preload="auto"></audio>
            <audio id="fact_rare" src="/assets/audio/text/fact_rare.mp3" preload="auto"></audio>
            <audio id="bucket_desktop" src="/assets/audio/text/bucket_desktop.mp3" preload="auto"></audio>
            <audio id="bucket_mobile" src="/assets/audio/text/bucket_mobile.mp3" preload="auto"></audio>
            <audio id="bucket_end" src="/assets/audio/text/bucket_end.mp3" preload="auto"></audio>

            
        </a-assets>

  <!--Ambient Sounds-->
  <a-entity class="ambient-music" id ="marsh" sound="src:#marsh_sound; autoplay:false; loop:true; volume:6;" position="0 10 -2.751"></a-entity>
  <a-entity class="ambient-music" id ="music" sound="src:#music_sound; autoplay:false; loop:true; volume:3;" position="0 10 -2.751"></a-entity>


    <!--Lighting-->

    <a-entity light="type: ambient; color: #f4aeae; intensity: 0.47"></a-entity>
    <a-entity id="light_spot" light="type: point; color: #feb4b4; intensity: 0.28; castShadow: true; shadowRadius: 2.52; shadowCameraFov: 92.15" position="-10.2275 31.31855 7.9395">
    </a-entity>
    </a-entity>


        <!--Player Controls-->
        <a-entity id="player" movement-controls="speed:0.2; constrainToNavMesh: true;" position="0 1.3 2.7">
            <a-entity
                id = "player2"
                camera="fov:70"
                wasd-controls='acceleration: 10'
                look-controls>
                <a-entity
                    id = "player-details"
                    collision-filter="group: mouse"
                    cursor="rayOrigin:mouse; fuseTimeout: 0;"
                    raycaster="far:8; interval:200; objects:.interactive"
                ></a-entity> 
            </a-entity>
        </a-entity>



    <a-entity>
        <a-entity
            id ="nav_mesh"
            scale='1 1 1'
            position = '0.442 1.3 -4.969'
            rotation = '0 171.220 0'
            gltf-model='#nav-mesh-obj'
            nav-mesh
            visible='false'
        ></a-entity>
    </a-entity>

    <a-entity user-interface></a-entity>
        


        <!--Environment Models-->
    <a-entity
            id ="environment"
            environment="preset: default; groundColor: #445; grid:none; ground:none; lighting:none; skyType:gradient; skyColor:#fd688d; horizonColor:#f5a951; fog:0.91">
        </a-entity>

        <a-entity
            id="environment_model"
            position="0.442 0.009 -4.969"
            rotation="0 171.220 0"
            scale= " 1 1 1"
            gltf-model="#environment-obj"
            shadow="cast:true; receive:true;">
        </a-entity>

        <a-entity id="tooltip1" position="-1.80348 0.96498 -3.3985" rotation="0 28.84 0" scale="0.7 0.7 0.7" shadow="cast:true; receive:false;">

            <a-entity id="tooltup-text1" text="value: Click me to learn a fact; align: center; color: #001d24; lineHeight: 54.49; font: /assets/fonts/Poppins-Regular-msdf.json; negate: false; width: 0.42; baseline: top; wrapCount: 7.41; side: double" rotation="" position="-0.00023 0.19395 0.02442">
            </a-entity>
    
            <a-entity id="tooltip-box1" position="0 -0.63939 0" rotation="" scale="0.5 0.5 0.5" gltf-model="/assets/tooltip.glb">
            </a-entity>
    </a-entity>

    <a-entity id="tooltip2" position="12.39163 0.653 -14.78472" rotation="0 -29.04 0" scale="0.7 0.7 0.7" shadow="receive: false">

        <a-entity id="tooltup-text2" text="value: Click me to pickup; align: center; color: #001d24; lineHeight: 54.49; font: /assets/fonts/Poppins-Regular-msdf.json; negate: false; width: 0.42; baseline: top; wrapCount: 7.41; side: double" rotation="" position="-0.00023 0.19395 0.02442">
        </a-entity>
    
        <a-entity id="tooltip-box2" position="0 -0.63939 0" rotation="" scale="0.5 0.5 0.5" gltf-model="/assets/tooltip.glb">
        </a-entity>
    </a-entity>


    <a-entity id="tooltip3" position="-3.099 0.886 -1.987" rotation="0 21.88 0" scale="0.7 0.7 0.7" shadow="receive: false" visible='false'>

        <a-entity id="tooltup-text3" text="value: Click me to pickup; align: center; color: #001d24; lineHeight: 54.49; font: /assets/fonts/Poppins-Regular-msdf.json; negate: false; width: 0.42; baseline: top; wrapCount: 7.41; side: double" rotation="" position="-0.00023 0.19395 0.02442">
        </a-entity>
    
        <a-entity id="tooltip-box3" position="0 -0.63939 0" rotation="" scale="0.5 0.5 0.5" gltf-model="/assets/tooltip.glb">
        </a-entity>
    </a-entity>


    <a-entity id="tooltip4" position="7.550 1.670 2.076" rotation="0 -100.75 0" scale="0.7 0.7 0.7" shadow="receive: false" visible='false'>

        <a-entity id="tooltup-text4" text="value: Click to water; align: center; color: #001d24; lineHeight: 54.49; font: /assets/fonts/Poppins-Regular-msdf.json; negate: false; width: 0.42; baseline: top; wrapCount: 7.41; side: double" rotation="" position="-0.00023 0.12713 0.02442">
        </a-entity>
    
        <a-entity id="tooltip-box4" position="0 -0.63939 0" rotation="" scale="0.5 0.5 0.5" gltf-model="/assets/tooltip.glb">
        </a-entity>
    </a-entity>


    <a-entity id="tooltip5" position="11.59766 1.33583 -16.41219" rotation="0 -6.91 0" scale="0.7 0.7 0.7" shadow="receive: false" visible="false">

        <a-entity id="tooltup-text5" text="value: Click me to shoot; align: center; color: #001d24; lineHeight: 54.49; font: /assets/fonts/Poppins-Regular-msdf.json; negate: false; width: 0.42; baseline: top; wrapCount: 7.41; side: double" rotation="" position="-0.00023 0.12713 0.02442">
        </a-entity>
    
        <a-entity id="tooltip-box5" position="0 -0.63939 0" rotation="" scale="0.5 0.5 0.5" gltf-model="/assets/tooltip.glb">
        </a-entity>
    </a-entity>


         <a-entity id="start_text1" text="value: STEP TO; align: center; color: #013440; lineHeight: 54.46; font: /assets/fonts/Poppins-Regular-msdf.json; negate: false; width: 2.39; baseline: top; wrapCount: 29.62; side: double" rotation="-90 -32.808 73.37297524445322" position="-2.635 0.17592 -0.573">
        </a-entity>

        <a-entity id="start_text2" text="value: START; align: center; color: #013440; lineHeight: 54.46; font: /assets/fonts/Poppins-SemiBold-msdf.json; negate: false; width: 4.63; baseline: top; wrapCount: 29.62; side: double" rotation="-90 -32.808 73.37297524445322" position="-2.489 0.17592 -0.423">
        </a-entity>

        


        <a-entity
            id="crane_group"
            position="0.442 0.009 -4.969"
            rotation="0 171.220 0"
            scale= " 1 1 1"
            gltf-model="#craneGroup-obj"
            shadow="cast:true; receive:true;">
        </a-entity>

        <a-entity
            fact-task
            id="crane1"
            class="interactive"
            position="2.081 0 -4.475"
            rotation="0 201 0"
            scale= " 1 1 1"
            gltf-model="#crane-obj"
            shadow="cast:true; receive:false;"
            animation__mouseenter="property:scale; to: 1.05 1.05 1.05; startEvents:mouseenter; dur:200"
            animation__mouseleave="property:scale; to: 1 1 1; startEvents:mouseleave; dur:200">
         </a-entity>

        
        <a-entity
            fact-task
            id="crane2"
            class="interactive"
            position="-1.34072 0 -3.88052"
            rotation="0 21.7 0"
            scale=""
            gltf-model="/assets/crane.glb"
            shadow="receive: false"
            animation__mouseenter="property: scale; to: 1.05 1.05 1.05; startEvents: mouseenter; dur: 200"
            animation__mouseleave="property: scale; to: 1 1 1; startEvents: mouseleave; dur: 200">
        </a-entity>

        <a-entity
            fact-task
            id="crane3"
            class="interactive"
            position="-1.80301 0 -3.26395"
            rotation="0 9.53 0"
            scale="0.5 0.5 0.5"
            gltf-model="/assets/crane.glb"
            shadow="receive: false"
            animation__mouseenter="property: scale; to: 0.55 0.55 0.55; startEvents: mouseenter; dur: 200"
            animation__mouseleave="property: scale; to: 0.5 0.5 0.5; startEvents: mouseleave; dur: 200">
        </a-entity>


         <a-cylinder
            id="pad"
            class="interactive"
            position="-2.568 -0.027 -0.527"
            rotation="0 0 0"
            scale="1.5 1.5 1.5"
            radius="0.5"
            height="0.250"
            segments-radial="100"
            color="#b4fe7c"
            visible='true'>
        </a-cylinder>

        <a-entity id="crop_group1" class="interactive crop" position="8.78335 0.009 2.27288" rotation="0 171.22 0" scale="" gltf-model="#crop1-obj" shadow="" animation__mouseenter="property: scale; to: 1.02 1.02 1.02; startEvents: mouseenter; dur: 200" animation__mouseleave="property: scale; to: 1 1 1; startEvents: mouseleave; dur: 200">
        </a-entity>


        <a-entity id="crop_group2" class="interactive crop" position="7.67266 0.009 9.3335" rotation="0 171.22 0" scale="" gltf-model="/assets/crop_group.glb" shadow="" animation__mouseenter="property: scale; to: 1.02 1.02 1.02; startEvents: mouseenter; dur: 200" animation__mouseleave="property: scale; to: 1 1 1; startEvents: mouseleave; dur: 200">
        </a-entity>


    

        <a-entity
            pickup
            dynamic-body
            id="bucket"
            position="-3.054 0 -1.904"
            rotation="0 0 0"
            scale= " 1 1 1"
            gltf-model="#bucket-obj"
            shadow="cast:true; receive:false;"
            animation__mouseenter="property:scale; to: 1.1 1.1 1.1; startEvents:mouseenter; dur:200"
            animation__mouseleave="property:scale; to: 1 1 1; startEvents:mouseleave; dur:200">
         </a-entity>

         <a-entity
            id="sign1"
            position="-3.930 0 -1.597"
            rotation="0 45 0"
            scale= " 1 1 1"
            gltf-model="#sign-obj"
            shadow="cast:true; receive:false;">
        </a-entity>


      <a-entity
            id="sign2"
            position="9.972 0 -15.048"
            rotation="0 14.310 0"
            scale= " 1 1 1"
            gltf-model="#sign-obj"
            shadow="cast:true; receive:false;">
        </a-entity>

         <a-entity
         id="target"
         class="interactive"
         position="11.59 0 -16.327"
         rotation="0 0 0"
         scale= " 1 1 1"
         gltf-model="#target-obj"
         shadow="cast:true; receive:false;">
     </a-entity>

     <a-entity
        gun-task
        pickup
        id="gun"
        body="type: dynamic; mass: 5; shape: none;"
        shape__box="shape: box;
                        halfExtents: 0.58 0.1 0.06;"
        class="interactive"
        position="12.33582 0.06 -14.83141"
        rotation="350 104.45 -7.29"
        scale="1 1 1"
        gltf-model="/assets/gun.glb"
        shadow="cast:true; receive:false;"
        animation__mouseenter="property:scale; to: 1.1 1.1 1.1; startEvents:mouseenter; dur:200"
        animation__mouseleave="property:scale; to: 1 1 1; startEvents:mouseleave; dur:200">
    </a-entity>

    <a-entity
        id="lily"
        class="interactive"
        position="0.442 0.009 -4.969"
        rotation="0 171.220 0"
        scale= " 1 1 1"
        gltf-model="#lily-obj"
        shadow="cast:true; receive:true;">
    </a-entity>

    <a-ocean
        bucket-task
        id = 'river'
        class="interactive ambient-music"
        position='1.471 -0.277 -14.118'
        rotation = '-90.000 0 0'
        scale='2.540 15.910 12.510'
        color ="#06454c"
        sound = "src:#water_sound; autoplay:false; loop:true; volume: 7;"
        ocean="opacity:0.9;  depth:1.1dw;  density: 10;  amplitude:0.000004;  amplitudeVariance:0.003;  speed:1;  speedVariance:0.9">
    </a-ocean> 


            <!--Physics Plane-->
        <a-plane
            id="plane"
            static-body
            position="0 -0.04 -4"
            rotation="-90 0 0"
            scale="2 2 2"
            width="19"
            height="22"
            color="#b3edff"
            visible="false"> 
        </a-plane>




    </a-scene>
</body>
</html>